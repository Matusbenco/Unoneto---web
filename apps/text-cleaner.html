<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Čistič Textu | OfficeSuite</title>
    <script src="coi-serviceworker.js"></script>

    <style>
        body { font-family: 'Segoe UI', system-ui, sans-serif; background: #f4f4f9; color: #333; margin: 0; padding: 20px; }
        
        .container { max-width: 1200px; margin: 0 auto; }
        
        h1 { text-align: center; color: #2d3748; margin-bottom: 10px; }
        p.subtitle { text-align: center; color: #718096; margin-bottom: 30px; }

        /* Hlavný Grid */
        .workspace {
            display: grid;
            grid-template-columns: 1fr 250px 1fr;
            gap: 20px;
            height: calc(100vh - 150px);
            min-height: 600px;
        }

        /* Textové polia */
        .text-panel { display: flex; flex-direction: column; background: white; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); padding: 15px; }
        
        .panel-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; font-weight: bold; color: #4a5568; }
        
        textarea {
            flex: 1; border: 1px solid #e2e8f0; border-radius: 8px; padding: 15px; 
            font-family: 'Courier New', monospace; font-size: 14px; line-height: 1.5; resize: none;
            outline: none; transition: border 0.2s;
        }
        textarea:focus { border-color: #3182ce; }

        /* Stats (počítadlo) */
        .stats { font-size: 0.85em; color: #a0aec0; margin-top: 5px; text-align: right; }

        /* Ovládací panel v strede */
        .controls { 
            display: flex; flex-direction: column; gap: 10px; overflow-y: auto; 
            padding-right: 5px; /* Pre scrollbar */
        }

        .btn-group { margin-bottom: 15px; }
        .group-title { font-size: 0.8em; text-transform: uppercase; letter-spacing: 1px; color: #a0aec0; margin-bottom: 5px; font-weight: bold; }

        button {
            width: 100%; padding: 10px; border: none; background: white; border-radius: 6px;
            cursor: pointer; text-align: left; font-size: 0.95em; color: #4a5568;
            transition: all 0.2s; border: 1px solid #e2e8f0; display: flex; align-items: center; gap: 8px;
        }

        button:hover { background: #ebf8ff; border-color: #3182ce; color: #2b6cb0; transform: translateX(3px); }
        button:active { transform: scale(0.98); }

        /* Hlavné akčné tlačidlá */
        .primary-btn { background: #3182ce; color: white; border: none; text-align: center; justify-content: center; font-weight: bold; }
        .primary-btn:hover { background: #2c5282; color: white; }

        .copy-btn { background: #38a169; color: white; border: none; text-align: center; justify-content: center; font-weight: bold; margin-top: auto; }
        .copy-btn:hover { background: #2f855a; color: white; }

        /* Responzivita pre mobily */
        @media (max-width: 900px) {
            .workspace { grid-template-columns: 1fr; height: auto; }
            .controls { display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); }
            textarea { height: 200px; }
        }

        /* Ikonky (Unicode) */
        .icon { width: 20px; text-align: center; display: inline-block; }

    </style>
</head>
<body>

    <div class="container">
        <h1>Čistič Textu</h1>
        <p class="subtitle">Oprava formátovania, odstránenie diakritiky a úprava textov.</p>

        <div class="workspace">
            
            <div class="text-panel">
                <div class="panel-header">
                    <span>Vstupný text</span>
                    <button onclick="clearAll()" style="width:auto; padding:5px 10px; font-size:0.8em; background:#fed7d7; color:#c53030; border:none;">Vymazať</button>
                </div>
                <textarea id="input" placeholder="Sem vlož text na úpravu..."></textarea>
                <div class="stats" id="stats-in">0 znakov | 0 slov</div>
            </div>

            <div class="controls">
                
                <button class="primary-btn" onclick="processText('clean-spaces')">✨ Vyčistiť všetko</button>

                <div class="btn-group">
                    <div class="group-title">Medzery a Riadky</div>
                    <button onclick="processText('remove-spaces')"><span class="icon">⎵</span> Odstrániť nadbytočné medzery</button>
                    <button onclick="processText('remove-breaks')"><span class="icon">↵</span> Odstrániť zlomy riadkov</button>
                    <button onclick="processText('trim')"><span class="icon">✂</span> Orezať okraje (Trim)</button>
                    <button onclick="processText('empty-lines')"><span class="icon">☰</span> Vymazať prázdne riadky</button>
                </div>

                <div class="btn-group">
                    <div class="group-title">Slovenčina</div>
                    <button onclick="processText('remove-accents')"><span class="icon">abc</span> Odstrániť diakritiku</button>
                    <button onclick="processText('fix-quotes')"><span class="icon">„“</span> Slovenské úvodzovky</button>
                </div>

                <div class="btn-group">
                    <div class="group-title">Veľkosť písmen</div>
                    <button onclick="processText('upper')"><span class="icon">AA</span> VŠETKO VEĽKÝM</button>
                    <button onclick="processText('lower')"><span class="icon">aa</span> všetko malým</button>
                    <button onclick="processText('capitalize')"><span class="icon">Aa</span> Prvé Písmená Veľké</button>
                    <button onclick="processText('sentence')"><span class="icon">A.</span> Veta. (Prvé veľké)</button>
                    <button onclick="processText('alternating')"><span class="icon">aA</span> sPoNgEbOb cAsE</button>
                </div>

                <div class="btn-group">
                    <div class="group-title">Programovanie</div>
                    <button onclick="processText('json-minify')"><span class="icon">{}</span> Minify JSON</button>
                    <button onclick="processText('strip-html')"><span class="icon">&lt;&gt;</span> Odstrániť HTML tagy</button>
                    <button onclick="processText('slug')"><span class="icon">-</span> URL Slug (url-format)</button>
                </div>

                <div class="btn-group">
                    <div class="group-title">Zoznamy</div>
                    <button onclick="processText('sort-az')"><span class="icon">A-Z</span> Zoradiť A-Z</button>
                    <button onclick="processText('unique')"><span class="icon">1</span> Odstrániť duplicity</button>
                </div>

            </div>

            <div class="text-panel">
                <div class="panel-header">Výsledok</div>
                <textarea id="output" readonly placeholder="Tu sa objaví výsledok..."></textarea>
                <div class="stats" id="stats-out">0 znakov | 0 slov</div>
                <button class="copy-btn" id="btn-copy" onclick="copyToClipboard()">Kopírovať výsledok</button>
            </div>

        </div>
    </div>

<script>
    const inputEl = document.getElementById('input');
    const outputEl = document.getElementById('output');
    const statsIn = document.getElementById('stats-in');
    const statsOut = document.getElementById('stats-out');

    // Live update štatistík
    function updateStats() {
        const count = (el, statEl) => {
            const text = el.value;
            const chars = text.length;
            const words = text.trim() === '' ? 0 : text.trim().split(/\s+/).length;
            const lines = text.split(/\r\n|\r|\n/).length;
            statEl.innerText = `${chars} znakov | ${words} slov | ${lines} riadkov`;
        };
        count(inputEl, statsIn);
        count(outputEl, statsOut);
    }

    inputEl.addEventListener('input', updateStats);

    // Hlavná funkcia na spracovanie
    function processText(action) {
        let text = inputEl.value;
        if (!text) return;

        switch(action) {
            case 'clean-spaces':
                // "Múdra" oprava: Duplicitné medzery na jednu, trim, oprava medzier okolo interpunkcie
                text = text.replace(/\s+/g, ' ').trim();
                text = text.replace(/\s+([.,!?:;])/g, '$1'); // Medzera pred bodkou -> preč
                break;
            
            case 'remove-spaces':
                text = text.replace(/ +/g, ' ');
                break;

            case 'remove-breaks':
                // Nahradí Enter medzerou
                text = text.replace(/(\r\n|\n|\r)/gm, " ");
                text = text.replace(/\s+/g, " ");
                break;

            case 'trim':
                text = text.split('\n').map(line => line.trim()).join('\n').trim();
                break;

            case 'empty-lines':
                text = text.split('\n').filter(line => line.trim() !== '').join('\n');
                break;

            case 'remove-accents':
                // Odstránenie diakritiky (NFD normalizácia)
                text = text.normalize("NFD").replace(/[\u0300-\u036f]/g, "");
                break;

            case 'fix-quotes':
                // Slovenské úvodzovky „text“
                text = text.replace(/"([^"]*)"/g, '„$1“');
                break;

            case 'upper': text = text.toUpperCase(); break;
            case 'lower': text = text.toLowerCase(); break;
            
            case 'capitalize':
                // Prvé Písmeno Každého Slova
                text = text.toLowerCase().split(' ').map(s => s.charAt(0).toUpperCase() + s.slice(1)).join(' ');
                break;

            case 'sentence':
                // Veta. (Len prvé veľké, ostatné malé)
                text = text.toLowerCase().replace(/(^\s*\w|[\.\!\?]\s*\w)/g, c => c.toUpperCase());
                break;

            case 'alternating':
                text = text.split('').map((c, i) => i % 2 === 0 ? c.toLowerCase() : c.toUpperCase()).join('');
                break;

            case 'json-minify':
                try {
                    text = JSON.stringify(JSON.parse(text));
                } catch(e) {
                    alert("Neplatný JSON!");
                }
                break;

            case 'strip-html':
                // Jednoduché odstránenie tagov
                text = text.replace(/<\/?[^>]+(>|$)/g, "");
                break;

            case 'slug':
                text = text.normalize("NFD").replace(/[\u0300-\u036f]/g, "")
                           .toLowerCase()
                           .replace(/[^a-z0-9]+/g, '-')
                           .replace(/^-+|-+$/g, '');
                break;

            case 'sort-az':
                text = text.split('\n').sort().join('\n');
                break;

            case 'unique':
                text = [...new Set(text.split('\n'))].join('\n');
                break;
        }

        outputEl.value = text;
        updateStats();
    }

    // Kopírovanie
    function copyToClipboard() {
        outputEl.select();
        document.execCommand('copy');
        
        const btn = document.getElementById('btn-copy');
        const originalText = btn.innerText;
        btn.innerText = "✅ Skopírované!";
        btn.style.background = "#2f855a";
        
        setTimeout(() => {
            btn.innerText = originalText;
            btn.style.background = "#38a169";
        }, 1500);
    }

    function clearAll() {
        inputEl.value = "";
        outputEl.value = "";
        updateStats();
        inputEl.focus();
    }

</script>

</body>
</html>